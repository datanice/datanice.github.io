<!DOCTYPE html>
<html lang="en">

<head>
  <!-- ## for client-side less
  <link rel="stylesheet/less" type="text/css" href="/theme/css/style.less">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/less.js/1.7.3/less.min.js" type="text/javascript"></script>
  -->
  <link rel="stylesheet" type="text/css" href="/theme/css/style.css">
  <link rel="stylesheet" type="text/css" href="/theme/css/pygments.css">
  <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=PT+Sans|PT+Serif|PT+Mono">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Hassen">
  <meta name="description" content="Posts and writings by Hassen">


<meta name="keywords" content="events, meetup API, pandas, python">

  <title>
    Datanice
&ndash; Find the perfect city for you using Meetups data  </title>

</head>

<body>
  <aside>
    <div id="user_meta">
      <a href="">
        <img src="/images/datanice_logo.png" alt="logo">
      </a>
      <h2 class="site-title"><a  href="/">Hassen</a></h2>
      <p>Exploring the world with data</p>
      <ul class="base-links">
        <li><a href="/pages/a-propos.html">About</a></li>
        <li><a href="http://getpelican.com/" target="_blank">Pelican</a></li>
        <li><a href="#" target="_blank">You can add links in your config file</a></li>
        <li><a href="#" target="_blank">Another social link</a></li>
      </ul>
    </div>
  </aside>

  <main>
    <header>
      <p>
      <a href="/">Index</a> &brvbar; <a href="/archives.html">Archives</a>
      </p>
    </header>

<article>
  <div class="article_title entry-title">
    <h3><a href="/find-the-perfect-city-for-you-using-meetups-data.html">Find the perfect city for you using Meetups data</a></h3>
  </div>
  <div class="article_text">
    <p>Some time ago I discovered a very nice tool to find nearby events and
things to do around. It's called <a href="http://www.citypulse.io">citypulse.io</a>
and I found it very useful.</p>
<p><a href="https://datanice.files.wordpress.com/2015/09/screenshot-from-2015-09-05-170729.png"><img alt="Screenshot from 2015-09-05
17:07:29" src="https://datanice.files.wordpress.com/2015/09/screenshot-from-2015-09-05-170729-e1441466003403.png" /></a><br />
Every night, they pull new data from:<!--more--></p>
<ul>
<li>Ticketmaster (UK &amp; US)</li>
<li>Eventbrite.com</li>
<li>Meetup.com (Meetup API)</li>
<li>Viagogo.</li>
</ul>
<p>After playing a little bit with the browser developper tools, I found
out the url to get the datapulse data for a given latitude and
longitude.  </p>
<p>Example:<a href="http://www.citypulse.io/api/event/GetEvents?startTime=2015-09-05T09:09:07.638Z&amp;startEndTime=2015-09-12T09:09:07.638Z&amp;nwLat=40.81538085107934&amp;nwLong=-74.14212817710876&amp;seLat=40.66086032810895&amp;seLong=-73.69512195152282&amp;categoryString=19,77,90,7,80,89,112,113,145,146,&amp;skip=100&amp;take=100&amp;mapZoom=11&amp;guid=47f1f28c-b855-4566-8da2-0151052209ad">http://www.citypulse.io/api/event/GetEvents?startTime=2015-09-05T09:09:07.638Z&amp;startEndTime=2015-09-12T09:09:07.638Z&amp;nwLat=40.81538085107934&amp;nwLong=-74.14212817710876&amp;seLat=40.66086032810895&amp;seLong=-73.69512195152282&amp;categoryString=19,77,90,7,80,89,112,113,145,146,&amp;skip=100&amp;take=100&amp;mapZoom=11&amp;guid=47f1f28c-b855-4566-8da2-0151052209ad<br />
</a></p>
<p>Thanks to this API I created a JSON file containing the  2015 events and
meetups for Los Angeles and New York. Let's explore the data !  </p>
<p><img alt="" src="https://images.unsplash.com/29/night-square.jpg?q=80&amp;fm=jpg&amp;s=3aab7af150b0717491f65e18dc481982" />Here
is a little python script that I put up to clean the data and plot some
bar charts to get insights. I use the pandas package which is very
practical to have a first glance of your data.</p>
<div class="highlight"><pre><span></span><span class="err"> </span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">locale</span>
<span class="n">locale</span><span class="o">.</span><span class="n">setlocale</span><span class="p">(</span><span class="n">locale</span><span class="o">.</span><span class="n">LC_NUMERIC</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="nb">all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s2">&quot;allData.json&quot;</span><span class="p">)</span>
<span class="nb">all</span><span class="o">.</span><span class="n">TicketPrice</span> <span class="o">=</span> <span class="nb">all</span><span class="o">.</span><span class="n">TicketPrice</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;$0.00&quot;</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">)</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
<span class="nb">all</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">all</span><span class="o">.</span><span class="n">TicketPrice</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">locale</span><span class="o">.</span><span class="n">atof</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:])))</span>
<span class="nb">all</span><span class="p">[</span><span class="s1">&#39;isFree&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">all</span><span class="o">.</span><span class="n">price</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
<span class="nb">all</span><span class="p">[</span><span class="s1">&#39;city&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">all</span><span class="o">.</span><span class="n">RegionId</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="mi">3639</span><span class="p">:</span><span class="s1">&#39;Los Angeles&#39;</span><span class="p">,</span><span class="mi">3633</span><span class="p">:</span><span class="s1">&#39;New York&#39;</span><span class="p">})</span>

<span class="c1">#all.price.argmax()</span>
<span class="c1">#all = all.drop(all.index[52])</span>

<span class="n">gro</span> <span class="o">=</span> <span class="nb">all</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;CategoryName&#39;</span><span class="p">,</span><span class="s1">&#39;city&#39;</span><span class="p">])</span>
<span class="n">temp0</span> <span class="o">=</span> <span class="n">gro</span><span class="o">.</span><span class="n">CategoryName</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">my_plot1</span> <span class="o">=</span> <span class="n">temp0</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Number of events per event category [Week 1 September 2015]&quot;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">my_plot1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Event category&quot;</span><span class="p">)</span>
<span class="n">my_plot1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Number of events&quot;</span><span class="p">)</span>


<span class="n">temp2</span> <span class="o">=</span> <span class="n">gro</span><span class="o">.</span><span class="n">isFree</span><span class="o">.</span><span class="kp">sum</span><span class="p">()</span><span class="o">/</span><span class="n">gro</span><span class="o">.</span><span class="n">isFree</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">my_plot2</span> <span class="o">=</span> <span class="n">temp2</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Percentage of Free events [Week 1 September 2015]&#39;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">my_plot2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Event category&quot;</span><span class="p">)</span>
<span class="n">my_plot2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Percentage of Free events&quot;</span><span class="p">)</span>

<span class="n">temp1</span> <span class="o">=</span> <span class="n">gro</span><span class="o">.</span><span class="n">price</span><span class="o">.</span><span class="kp">sum</span><span class="p">()</span><span class="o">/</span><span class="p">(</span><span class="n">gro</span><span class="o">.</span><span class="n">price</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">-</span><span class="n">gro</span><span class="o">.</span><span class="n">isFree</span><span class="o">.</span><span class="kp">sum</span><span class="p">())</span>
<span class="n">my_plot3</span> <span class="o">=</span> <span class="n">temp1</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Mean price per event category [Week 1 September 2015]&#39;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">my_plot3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Event category&quot;</span><span class="p">)</span>
<span class="n">my_plot3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Mean price of events&quot;</span><span class="p">)</span>
</pre></div>


<p>First I fill the empty strings in the ticket price column and replace ""
with "\$0.00".<br />
Then I create a column "isFree" which will be useful to see which kind
of events are free in each city, but also to get the number of non free
events used to compute the mean price of the tickets.</p>
<p>Here are the results :<br />
<a href="https://datanice.files.wordpress.com/2015/09/screenshot-from-2015-09-05-183907.png"><img alt="Screenshot from 2015-09-05
18:39:07" src="https://datanice.files.wordpress.com/2015/09/screenshot-from-2015-09-05-183907.png?w=660" /></a></p>
<p>In the chart above, we can see that Los Angeles has more online events
organised with a noticeable difference in the number of Learning meetups
that could be explained by the important number of tech meetups in the
area.</p>
<p><a href="https://datanice.files.wordpress.com/2015/09/screenshot-from-2015-09-05-183920.png"><img alt="Screenshot from 2015-09-05
18:39:20" src="https://datanice.files.wordpress.com/2015/09/screenshot-from-2015-09-05-183920.png?w=660" /></a></p>
<p>The chart above shows that there is no big difference in the percentage
of free events in every category. The data for the Comedy category
cannot be trusted because of the small number of events of this type in
the dataset.<a href="https://datanice.files.wordpress.com/2015/09/screenshot-from-2015-09-05-183933.png"><img alt="Screenshot from 2015-09-05
18:39:33" src="https://datanice.files.wordpress.com/2015/09/screenshot-from-2015-09-05-183933.png?w=660" /></a></p>
<p>The chart above shows the mean price for the events of each category.</p>
<p>Note :<br />
Before getting the data for the whole year, I started by looking at the
data for one month. The chart for the percentage of free events looked
different for that range, Looking at a large dataset is a way to get rid
of these biases.</p>
<p>Next Steps and Improvements:<br />
-Looking at the evolution of trends over the years<br />
-Compare with more cities</p>
  </div>
  <div class="article_meta">
    <p>Posted on: Mon 07 September 2015</p>
    <p>Category: <a href="/category/non-classe.html">Non classé</a>
 &ndash; Tags:
      <a href="/tag/events.html">events</a>,      <a href="/tag/meetup-api.html">meetup API</a>,      <a href="/tag/pandas.html">pandas</a>,      <a href="/tag/python.html">python</a>    </p>
  </div>


</article>


    <div id="ending_message">
      <p>&copy; Hassen. Built using <a href="http://getpelican.com" target="_blank">Pelican</a>. Theme by Giulio Fidente on <a href="https://github.com/gfidente/pelican-svbhack" target="_blank">github</a>. </p>
    </div>
  </main>
</body>
</html>